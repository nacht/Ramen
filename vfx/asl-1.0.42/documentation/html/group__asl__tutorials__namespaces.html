<!--
    Copyright 2005-2008 Adobe Systems Incorporated
    Distributed under the MIT License (see accompanying file LICENSE_1_0_0.txt
    or a copy at http://stlab.adobe.com/licenses.html)

    Some files are held under additional license.
    Please see "http://stlab.adobe.com/licenses.html" for more information.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <TITLE>Adobe Software Technology Lab: Namespaces</TITLE>
    <META HTTP-EQUIV="content-type" CONTENT="text/html;charset=ISO-8859-1"/>
    <LINK TYPE="text/css" REL="stylesheet" HREF="adobe_source.css"/>
    <LINK REL="alternate" TITLE="stlab.adobe.com RSS" HREF="http://sourceforge.net/export/rss2_projnews.php?group_id=132417&amp;rss_fulltext=1" TYPE="application/rss+xml"/>
    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
</head>
<body>
<div id='content'>
<table><tr>
<td colspan='5'>
    <div id='opensource_banner'>
    <table style='width: 100%; padding: 5px;'><tr>
    <td align='left'>
        <a href='index.html' style='border: none'><img src='stlab2007.jpg' alt="stlab.adobe.com"/></a>
    </td>
    <td align='right'>
        <a href='http://www.adobe.com' style='border: none'><img src='adobe_hlogo.gif' alt="Adobe Systems Incorporated"/></a>
    </td>
    </tr></table>
    </div>
</td></tr><tr>
<td valign="top">
    <div id='navtable' height='100%'>
    <div style='margin: 5px'>
        <h4>Documentation</h4>

        <a href="group__asl__overview.html">Overview</a><br/>
        <a href="asl_readme.html">Building ASL</a><br/>
        <a href="asl_toc.html">Documentation</a><br/>
        <a href="http://stlab.adobe.com/wiki/index.php/Supplementary_ASL_Documentation">Library Wiki Docs</a><br/>
        <a href="asl_indices.html">Indices</a><br/>
        <a href="http://stlab.adobe.com/perforce/">Browse Perforce</a><br/>

        <h4>More Info</h4>

        <a href="asl_release_notes.html">Release Notes</a><br/>
        <a href="http://stlab.adobe.com/wiki/">Wiki</a><br/>
        <a href="asl_search.html">Site Search</a><br/>
        <a href="licenses.html">License</a><br/>
        <a href="success_stories.html">Success Stories</a><br/>
        <a href="asl_contributors.html">Contributors</a><br/>

        <h4>Media</h4>

        <a href="http://sourceforge.net/project/showfiles.php?group_id=132417&amp;package_id=145420">Download</a><br/>
        <a href="asl_download_perforce.html">Perforce Depots</a><br/>

        <h4>Support</h4>

        <a href="http://sourceforge.net/projects/adobe-source/">ASL SourceForge Home</a><br/>
        <a href="http://sourceforge.net/mail/?group_id=132417">Mailing Lists</a><br/>
        <a href="http://sourceforge.net/forum/?group_id=132417">Discussion Forums</a><br/>
        <a href="http://sourceforge.net/tracker/?atid=724218&amp;group_id=132417&amp;func=browse">Report Bugs</a><br/>
        <a href="http://sourceforge.net/tracker/?atid=724221&amp;group_id=132417&amp;func=browse">Suggest Features</a><br/>
        <a href="asl_contributing.html">Contribute to ASL</a><br/>

        <h4>RSS</h4>

        <a href="http://sourceforge.net/export/rss2_projnews.php?group_id=132417">Short-text news</a><br/>
        <a href="http://sourceforge.net/export/rss2_projnews.php?group_id=132417&amp;rss_fulltext=1">Full-text news</a><br/>
        <a href="http://sourceforge.net/export/rss2_projfiles.php?group_id=132417">File releases</a><br/>

        <h4>Other Adobe Projects</h4>

        <a href="adobe_apollo.html">Adobe Air</a><br/>
        <a href="http://stlab.adobe.com/gil/">Adobe GIL</a><br/>
        <a href="http://stlab.adobe.com/performance/">C++ Benchmarks</a><br/>
        <a href="http://labs.adobe.com">Adobe Labs</a><br/>
        <a href="http://stlab.adobe.com/amg/">Adobe Media Gallery</a><br/>
        <a href="http://www.adobe.com/products/xmp/">Adobe XMP</a><br/>
        <a href="http://www.mozilla.org/projects/tamarin">Tamarin project<br/>(Mozilla Foundation)</a><br/>

        <h4>Other Resources</h4>

        <a href="http://boost.org">Boost</a><br/>
        <a href="http://www.riaforge.com/">RIAForge</a><br/>
        <a href="http://www.sgi.com/tech/stl">SGI STL</a><br/>
    </div>
    </div>
</td>
<td id='maintable' width="100%" valign="top">

<!-- End Header -->
<!-- Generated by Doxygen 1.5.9 -->
<div class="contents">
<h1>Namespaces<br>
<small>
[<a class="el" href="group__asl__tutorials.html">ASL Tutorials</a>]</small>
</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
</table>
<h2><a class="anchor" name="namespace_usage">
Basic Usage</a></h2>
Namespaces in ASL provide a "semantic space". The idea of a semantic space is that a construct such as:<p>
<div class="fragment"><pre class="fragment"><span class="keyword">using namespace </span>adobe;
</pre></div><p>
Implies that any unqualifed name subsequently used in the same scope will have the same semantics as the function defined in the <a class="el" href="namespaceadobe.html">adobe</a> namespace. This may be a function which is defined in a different namespace but picked up through the argument dependent lookup (ADL or Koenig Lookup) feature of C++.<p>
Within the ASL library, if the semantics of a function are substantially similar to a function defined in the standard library or in one of the libraries upon which ASL depends, then we will attempt to use the same function name. At times this can create ambiguities though these ambiguities can typically be resolved by qualifying the function call.<p>
All public functions and classes in ASL are available in namespace <code><a class="el" href="namespaceadobe.html">adobe</a></code>.<p>
 <div class="fragment"><pre class="fragment">{ 
<span class="comment">// Fully qualified names</span>

    <a class="code" href="classadobe_1_1forest.html" title="A homogeneous hierarchical structure class.">adobe::forest&lt;int&gt;</a> my_forest;
    
    <a class="code" href="group__find.html#g3ca10f4d1b45a1648140f00ef752bad3" title="find implementation">adobe::find</a>(my_forest, 5);

}
</pre></div><p>
Namespace aliases can be used to shorten usage:<p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Using aliases to shorten qualifiers</span>

    <span class="keyword">namespace </span>asl = adobe;
    
    asl::forest&lt;int&gt; my_forest;
    
    <a class="code" href="group__find.html#g3ca10f4d1b45a1648140f00ef752bad3" title="find implementation">asl::find</a>(my_forest, 5);

}
</pre></div><p>
With a using directive, names may need to be qualified.<p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Qualifying names to avoid ambiguity</span>

    <span class="keyword">using namespace </span>std;
    <span class="keyword">using namespace </span>adobe;
    
    <span class="keywordtype">bool</span> my_predicate(<span class="keywordtype">int</span>);
    forest&lt;int&gt; my_forest;
    
<span class="comment">// qualifier required on find_if to avoid ambiguity</span>
    <a class="code" href="group__find.html#g0a25e9c250049be523a4e0e9d485650d" title="find implementation">adobe::find_if</a>(my_forest.begin(), my_forest.end(), &amp;my_predicate);
}
</pre></div><p>
Namespace using directives with unqualified names allow for argument dependent lookup. This can cause ambiguities:<p>
 <div class="fragment"><pre class="fragment">{ 
<span class="comment">// This results in an ambiguity and won't compile</span>

    <span class="keyword">using namespace </span>adobe;
    
    <span class="keywordtype">bool</span> my_predicate(<span class="keywordtype">int</span>);
    std::vector&lt;int&gt; my_vector;
    
    <a class="code" href="group__find.html#g0a25e9c250049be523a4e0e9d485650d" title="find implementation">find_if</a>(my_vector.begin(), my_vector.end(), &amp;my_predicate); <span class="comment">// adobe or std?</span>
}
</pre></div><h2><a class="anchor" name="namespace_swap">
Providing and Calling a Swap Function</a></h2>
Swap is a critical primitive, like copy construction and assignment. The assumption made is that swapping two elements will <em>never</em> throw an exception and will operate in time proportional to the local parts of the object. For example, if I swap two vectors, it will simply swap the pointers to the remote part of the vector, not actually do an element-by-element swap.<p>
The problem is, how do you define your own "swap()" function for your type? There are issues with name lookup ordering if you were to overload the <a class="el" href="namespacestd.html#d53fe96196520ac16ec886c7ea05149b">std::swap()</a> function - so the standard committee has decided that the way to handle it is that <a class="el" href="classadobe_1_1circular__queue.html#f2f3484d59224cfe3afc9e42a8728020">swap()</a> should always be called unqualified, allowing argument dependent lookup to find the correct <a class="el" href="classadobe_1_1circular__queue.html#f2f3484d59224cfe3afc9e42a8728020">swap()</a>. A conforming STL implementation has to ensure that swap is always called unqualified.<p>
This becomes a problem for generic code - because there is no swap that ADL could find for built-in types. The solution ASL recommends is to pull <a class="el" href="namespacestd.html#d53fe96196520ac16ec886c7ea05149b">std::swap</a> into your namespace with <code>"using std::swap;"</code> before calling.<p>
The swap function is a fundamental operation of regular types. ASL strengthens the requirements on an assignable type to include a callable, non-throwing, swap. The C++ standards committee recognizes the importance of swap and has proposed adding a swappable requirement to a number of standard algorithms (see <a href="http://std.dkuug.dk/jtc1/sc22/wg21/docs/papers/2003/n1523.htm">N1523=03-0106</a>).<p>
When implementing an assignable, non-POD, class a swap function should be defined in the same namespace as the class.<h2><a class="anchor" name="namespace_specializations">
Providing Other Specializations</a></h2>
ASL class templates may be specialized (partially or fully) and ASL function templates may be specialized. In both cases the type(s) for the specialization must be in a unique namespace and externally visible. For ASL algorithms which extend standard algorithms, it is recommended that only the standard version be specialized and the ASL function will invoke it. It is strongly recommended that the template be specialized using qualified names rather than reopening the namespace. Classes and functions are specialized in the <code><a class="el" href="namespaceadobe.html">adobe</a></code> namespace. It is also strongly recommended that the template specialization appear in the same header as the type being specialized for, so as to avoid header file dependencies.<p>
 <div class="fragment"><pre class="fragment">

<span class="preprocessor">#include &lt;algorithm&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="algorithm_8hpp.html">adobe/algorithm.hpp</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="memory_8hpp.html">adobe/memory.hpp</a>&gt;</span>

<span class="keyword">namespace </span>my_namespace {

<span class="keyword">class </span>my_iterator
{
<span class="comment">// ...</span>
};

<span class="keyword">class </span>my_class
{
<span class="comment">// ...</span>
};

} <span class="comment">// my_namespace</span>

<span class="comment">// specialize find for my_iterator - specialize in the std namespace</span>

<span class="keyword">template</span> &lt;&gt;
my_namespace::my_iterator <a class="code" href="group__find.html#g3ca10f4d1b45a1648140f00ef752bad3" title="find implementation">std::find</a>(my_namespace::my_iterator, my_namespace::my_iterator)
{
    <span class="comment">// do special find</span>
}

<span class="comment">// specialize ptr_traits for my_class</span>

<span class="keyword">template</span> &lt;&gt;
<span class="keyword">struct </span>adobe::ptr_traits&lt;my_namespace::my_class&gt;
{
    <span class="keyword">typedef</span> my_namespace::my_class  element_type;
    <span class="keyword">typedef</span> element_type*           pointer_type;
    <span class="keyword">typedef</span> <span class="keyword">const</span> element_type*     const_pointer_type
    
    <span class="keyword">template</span> &lt;<span class="keyword">class</span> U&gt; <span class="keyword">struct </span>rebind { <span class="keyword">typedef</span> adobe::ptr_traits&lt;U&gt; other; };
    <span class="keyword">enum</span> { is_array = <span class="keyword">false</span> };
    
    <span class="keyword">static</span> <span class="keywordtype">void</span> delete_ptr(pointer_type x) <span class="keywordflow">throw</span>() { <span class="keyword">delete</span> x; }
};


<span class="comment">/// end_recommended_specialization</span>
</pre></div><p>
Functions provided by ASL cannot be safely overloaded. ASL will attempt to provide traits classes providing needed functionality where it is suspected a function overload would be desirable and complete specialization isn't sufficient. If you have a need for overloading an ASL function please send a note to <a href="mailto:adobe-source-devel@lists.sourceforge.net">adobe-source-devel@lists.sourceforge.net</a>.<h2><a class="anchor" name="macros_extern_c">
Macros and Extern "C" Functions</a></h2>
All macros defined in ASL are defined with all capitals and prefixed with <code>ADOBE_</code> . Names which are intended for library internal use only are prefixed with <code>ADOBE_IMPLEMENTATION_</code> . Any name declared <code>extern</code> <code>"C"</code> (of which there are currently no examples) will follow the same convention with lower case letters.<h2><a class="anchor" name="namespace_details">
Advanced Details</a></h2>
Namespaces where introduced into C++ as a mechanism to control name collisions. However, the introduction of Generic Programming complicates matters considerably.<p>
In specifying these guidelines the following goals were considered:<p>
<ul>
<li>Any set of libraries, even those providing overlapping functionality, with different primary namespaces, should not conflict.</li><li>Any set of declarations with matching semantics should have matching names, including namespace.</li><li>The C++ standard should not be violated - rather issues with the standard should be addressed through the standard committee.</li></ul>
<p>
Unfortunately, the first two of these goals often come into conflict. Part of the problem is the lack of function partial specialization support, however, in cases of general extensions to a library it is difficult to come up with _any_ set of rules which would satisfy the first goal. Here we have tried to provide a reasonable balance which handles most cases.<h3><a class="anchor" name="namespace_visibility">
Hiding Non-Public Details</a></h3>
Implementation details are hidden using one of two mechanisms. In .cpp files, implementation details are included in an unnamed namespace[1]. In .hpp header files, implementation details are provided in the namespace <code>adobe::implementation</code>. Under no circumstances should client code refer to namespace <code>adobe::implementation</code>.<h3><a class="anchor" name="namespace_adl">
Managing Argument Dependent Lookup</a></h3>
[to be written]<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>[1] See section 7.3.1.1 of the C++ standard. </dd></dl>
</div>

<!-- Begin Footer -->
</td></tr>
</table>
</div> <!-- content -->
<div class='footerdiv'>
    <div id='footersub'>
        <ul>
            <li><a href="http://www.adobe.com/go/gftray_foot_aboutadobe">Company</a>&nbsp;|&nbsp;</li>
            <li><a href="http://www.adobe.com/go/gftray_foot_privacy_security">Online Privacy Policy</a>&nbsp;|&nbsp;</li>
            <li><a href="http://www.adobe.com/go/gftray_foot_terms">Terms of Use</a>&nbsp;|&nbsp;</li>
    
            <li><a href="http://www.adobe.com/go/gftray_foot_contact_adobe">Contact Us</a>&nbsp;|&nbsp;</li>
            <li><a href="http://www.adobe.com/go/gftray_foot_accessibility">Accessibility</a>&nbsp;|&nbsp;</li>
            <li><a href="http://www.adobe.com/go/gftray_foot_report_piracy">Report Piracy</a>&nbsp;|&nbsp;</li>
            <li><a href="http://www.adobe.com/go/gftray_foot_permissions_trademarks">Permissions &amp; Trademarks</a>&nbsp;|&nbsp;</li>
            <li><a href="http://www.adobe.com/go/gftray_foot_product_license_agreements">Product License Agreements</a>&nbsp;|&nbsp;</li>
    
            <li><a href="http://www.adobe.com/go/gftray_foot_feedback">Send Feedback</a></li>
        </ul>
        <div>
            <p>Copyright &#169; 2006-2007 Adobe Systems Incorporated.</p>
            <p>Use of this website signifies your agreement to the <a href="http://www.adobe.com/go/gftray_foot_terms">Terms of Use</a> and <a href="http://www.adobe.com/go/gftray_foot_privacy_security">Online Privacy Policy</a>.</p>
            <p>Search powered by <a href="http://www.google.com/" target="new">Google</a></p>
        </div>
	</div>
</div>
<script type="text/javascript">
_uacct = "UA-396569-1";
urchinTracker();
</script>
</body>
</html>
